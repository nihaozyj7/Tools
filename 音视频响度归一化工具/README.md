# 音视频响度归一化工具

一个用于将音视频文件的响度标准化到统一水平的工具，使用FFmpeg进行处理，保持原有音质和元数据。

## 功能特点

- **响度标准化**: 使用FFmpeg的loudnorm滤镜，将音频响度标准化到-23 LUFS（符合ITU-R BS.1770-4标准）
- **多格式支持**: 支持MP4、MKV、MP3、FLAC、AAC、M4A、WAV等多种音视频格式
- **批量处理**: 支持批量添加文件或整个文件夹进行队列处理
- **保留元数据**: 处理过程中保留原有视频、字幕等流，仅调整音频响度
- **递归扫描**: 支持递归扫描文件夹中的所有音视频文件
- **实时进度**: 显示处理进度和日志信息
- **智能跳过**: 自动检测并跳过无音频流的文件
- **自动替换**: 处理完成后自动替换原始文件，无需手动操作

## 使用方法

### 1. 准备工作
- 安装Python 3.x
- 安装FFmpeg并将其添加到系统PATH环境变量中
- 安装必要的依赖库

### 2. 依赖安装
```bash
pip install PyQt6
```

### 3. 启动工具
运行`音视频响度归一化工具.py`文件启动GUI界面

### 4. 添加文件
- **添加文件**: 点击"添加文件"按钮，选择要处理的音视频文件
- **添加文件夹**: 点击"添加文件夹"按钮，选择包含音视频文件的目录
- **递归扫描**: 勾选"递归扫描文件夹"选项，将扫描子文件夹中的文件

### 5. 处理操作
- **查看队列**: 添加的文件会显示在"待处理文件队列"列表中
- **清空队列**: 点击"清空队列"按钮清空所有待处理文件
- **开始处理**: 点击"开始处理队列"按钮启动批量处理
- **查看日志**: 处理过程和结果会显示在"处理日志"区域

### 6. 参数说明
- **响度标准**: 工具使用-23 LUFS的国际标准（ITU-R BS.1770-4）
- **容限峰值**: 峰值容限为-2 LU，确保不会过度压缩
- **响度范围**: 响度范围设定为11 LU，保持动态范围

## 注意事项

- **FFmpeg依赖**: 必须安装FFmpeg并确保在命令行中可执行
- **文件备份**: 处理会直接替换原始文件，建议事先备份重要文件
- **处理时间**: 大文件的处理可能需要较长时间，请耐心等待
- **存储空间**: 确保有足够的存储空间用于处理过程中的临时文件
- **音频检测**: 工具会自动检测文件是否包含音频流，无音频流的文件将被跳过
- **编码格式**: 处理后音频采用AAC编码，保持高质量的同时优化文件大小

## 常见问题

**Q: 提示"未找到FFmpeg"怎么办？**
A: 请下载并安装FFmpeg，将其bin目录添加到系统PATH环境变量中。

**Q: 为什么有些文件会被跳过？**
A: 工具会跳过没有音频流的文件（如纯视频或纯图片），避免不必要的处理。

**Q: 响度归一化会影响音质吗？**
A: 工具使用专业的loudnorm滤镜，能够在保持音质的同时调整响度，避免过度压缩。

**Q: 处理后的文件和原文件有什么区别？**
A: 只有音频响度被调整到标准水平，视频、字幕等其他流和元数据保持不变。